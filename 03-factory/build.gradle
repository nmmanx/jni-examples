plugins {
    id 'cpp-library'
    id 'application'
}

application {
    mainClass = 'jniexamples.factory.Main'
}

library {
    targetMachines.add(machines.linux.x86_64)
    linkage = [Linkage.SHARED]
    baseName = 'factory'
}

tasks.withType(CppCompile).configureEach {
    compilerArgs.add '-fPIC'
    compilerArgs.add "-I${org.gradle.internal.jvm.Jvm.current().javaHome}/include"
    compilerArgs.add "-I${org.gradle.internal.jvm.Jvm.current().javaHome}/include/linux"
}

run {
    systemProperty "java.library.path", file("${buildDir}/lib/main/release").absolutePath
}